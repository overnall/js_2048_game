var t,e={};const s=new((t=class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.score=0,this.status="idle",this.initialState=t,this.state=t.map(t=>[...t])}areArraysEqual(t,e){for(let s=0;s<4;s++)for(let r=0;r<4;r++)if(t[s][r]!==e[s][r])return!1;return!0}move(t){if("playing"!==this.status)return;let e=this.state.map(t=>[...t]);if("left"===t)this.state=this.state.map(t=>this.mergeRow(t));else if("right"===t){let t=this.state;t=this.state.map(t=>this.mergeRow([...t].reverse()).reverse()),this.state=t}else if("up"===t)for(let t=0;t<4;t++){let e=[];for(let s=0;s<4;s++)e.push(this.state[s][t]);let s=this.mergeRow(e);for(let e=0;e<4;e++)this.state[e][t]=s[e]}else if("down"===t)for(let t=0;t<4;t++){let e=[];for(let s=3;s>=0;s--)e.push(this.state[s][t]);let s=this.mergeRow(e);for(let e=3;e>=0;e--)this.state[e][t]=s[3-e]}this.areArraysEqual(this.state,e)||(this.addRandomBlock(),this.canMove()||(this.status="lose"))}mergeRow(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e.splice(t+1,1),2048===e[t]&&(this.status="win"));for(;e.length<4;)e.push(0);return e}canMove(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e])return!0;for(let t=0;t<4;t++)for(let e=0;e<3;e++)if(this.state[t][e]===this.state[t][e+1]||this.state[e][t]===this.state[e+1][t])return!0;return!1}moveLeft(){this.move("left")}moveRight(){this.move("right")}moveUp(){this.move("up")}moveDown(){this.move("down")}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){"idle"===this.status&&(this.status="playing",this.addRandomBlock(),this.addRandomBlock())}restart(){this.score=0,this.status="idle",this.state=this.initialState.map(t=>[...t])}addRandomBlock(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push([e,s]);if(0===t.length)return;let[e,s]=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.9>Math.random()?2:4}}).__esModule?t.default:t),r=document.querySelector(".button.start");function a(){let t=s.getState();document.querySelector(".game-score").textContent=s.getScore(),document.querySelectorAll(".field-cell").forEach((e,r)=>{let a=t[Math.floor(r/4)][r%4];e.className="field-cell",0!==a&&e.classList.add(`field-cell--${a}`),e.textContent=a||"",document.querySelector(".message-start").classList.toggle("hidden","idle"!==s.getStatus()),document.querySelector(".message-lose").classList.toggle("hidden","loss"!==s.getStatus()),document.querySelector(".message-win").classList.toggle("hidden","win"!==s.getStatus())}),"idle"===s.getStatus()?(r.textContent="Start",r.classList.remove("restart"),r.classList.add("start")):(r.textContent="Restart",r.classList.remove("start"),r.classList.add("restart")),"win"===s.getStatus()?document.querySelector(".message-win").classList.remove("hidden"):"lose"===s.getStatus()&&document.querySelector(".message-lose").classList.remove("hidden")}document.addEventListener("keydown",t=>{switch(t.key){case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight();break;case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown()}a()}),r.addEventListener("click",()=>{"idle"===s.getStatus()?s.start():s.restart(),a()}),a();
//# sourceMappingURL=index.72a1e0fa.js.map
